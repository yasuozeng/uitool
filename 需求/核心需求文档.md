# UI 自动化平台 核心需求文档

## 文档信息
- **项目名称**: uiTool1.0
- **文档版本**: v1.0
- **文档类型**: 产品需求文档（PRD）
- **创建日期**: 2025-12-27
- **目标用户**: 测试团队/QA工程师

---

## 1. 项目概述

### 1.1 项目背景

**业务痛点**：
- 手工测试效率低下，重复性工作占用大量人力
- 回归测试成本高，每次版本更新需要大量时间验证
- 测试覆盖度难以保证，容易遗漏边界场景
- 测试结果难以追溯，缺乏统一的测试资产管理

**项目价值**：
- 提升测试效率，减少重复性手工劳动
- 降低人力成本，释放测试人员时间
- 提高测试覆盖度和质量保障能力
- 实现测试资产的可复用和可维护

**市场定位**：
面向中小型团队的轻量级 Web UI 自动化测试平台，简单易用，快速上手。

### 1.2 项目目标

**短期目标**（3个月内）：
- 完成核心功能开发（脚本编辑、执行、报告）
- 支持3种主流浏览器（Chrome、Firefox、Edge）
- 实现基础用例管理功能

**长期目标**（6-12个月）：
- 支持分布式执行
- 引入代码编辑模式
- 提升平台稳定性和性能

### 1.3 项目范围

**包含范围**：
- Web端UI自动化测试
- 测试脚本可视化管理
- 测试执行和结果展示
- 测试报告生成

**不包含范围**：
- 移动端APP自动化
- 接口自动化测试
- 性能测试
- 用户权限管理系统

---

## 2. 核心功能需求

### 2.1 测试脚本编辑器 (P0)

#### 2.1.1 可视化脚本编辑

**需求描述**：提供低代码/无代码的脚本编辑能力，让非技术背景的测试人员也能快速创建测试脚本。

**元素定位功能**：
| 定位方式 | 说明 | 优先级 |
|---------|------|-------|
| ID | 通过元素ID定位 | P0 |
| XPath | 通过XPath表达式定位 | P0 |
| CSS Selector | 通过CSS选择器定位 | P0 |
| Name | 通过name属性定位 | P1 |
| ClassName | 通过class名称定位 | P1 |

**操作步骤类型**：
| 操作类型 | 说明 | 参数 |
|---------|------|------|
| 点击 | 点击指定元素 | 元素定位符 |
| 输入文本 | 在输入框中输入文本 | 元素定位符、文本内容 |
| 清除 | 清除输入框内容 | 元素定位符 |
| 页面跳转 | 导航到指定URL | URL地址 |
| 等待元素 | 等待元素出现 | 元素定位符、超时时间 |
| 验证文本 | 验证页面包含指定文本 | 文本内容 |
| 验证元素存在 | 验证元素是否存在 | 元素定位符 |

**脚本结构管理**：
- 支持步骤的增删改查
- 支持步骤拖拽排序
- 支持步骤复制/粘贴
- 支持步骤注释说明

#### 2.1.2 代码编辑模式（阶段二）

**需求描述**：为高级用户提供直接编写代码的能力，支持更复杂的测试场景。

**功能要求**：
- JavaScript/Python 语法高亮
- 代码智能提示和自动补全
- 语法错误实时检测
- 代码格式化

### 2.2 测试用例管理 (P0)

#### 2.2.1 用例基本信息

| 字段 | 类型 | 必填 | 说明 |
|-----|------|-----|------|
| 用例名称 | 文本 | 是 | 唯一标识 |
| 用例描述 | 文本 | 否 | 详细说明 |
| 优先级 | 枚举 | 是 | P0/P1/P2/P3 |
| 标签 | 文本 | 否 | 用于分类和筛选 |

#### 2.2.2 用例编辑

- 用例的增删改查
- 用例步骤的可视化编辑
- 用例步骤的拖拽排序
- 用例批量操作

### 2.3 测试执行引擎 (P0)

#### 2.3.1 单用例执行

**需求描述**：支持单个测试用例的立即执行。

**功能要求**：
- 立即执行单个测试用例
- 实时显示当前执行步骤
- 步骤执行状态标识（成功/失败/进行中）
- 失败时自动截图


#### 2.3.2 批量执行

**需求描述**：支持多个用例的批量执行。

**执行方式**：
| 执行方式 | 说明 |
|---------|------|
| 多选执行 | 手动选择多个用例执行 |
| 目录执行 | 执行选中目录下所有用例 |
| 标签执行 | 按标签筛选后批量执行 |

**功能要求**：
- 执行结果汇总统计（成功数、失败数、跳过数）
- 执行进度展示
- 执行总时长统计

#### 2.3.3 实时日志

**需求描述**：提供详细的执行日志，方便问题定位。

**日志级别**：
- INFO：正常执行信息
- WARNING：警告信息
- ERROR：错误信息

**功能要求**：
- 日志时间戳
- 可展开/折叠日志详情
- 日志搜索和过滤



#### 2.3.5 浏览器选择

**需求描述**：支持多种浏览器执行测试。

| 浏览器 | 版本要求 | 优先级 |
|-------|---------|-------|
| Chrome | 90+ | P0 |
| Firefox | 88+ | P0 |
| Edge | 90+ | P0 |

**配置选项**：
- 无头模式（Headless）开关
- 窗口大小配置
- 浏览器启动参数配置

### 2.4 测试报告 (P0)

#### 2.4.1 报告内容

**需求描述**：生成详细的测试执行报告。

**报告内容**：
- 执行基本信息：执行时间、执行环境
- 执行结果统计：总数、成功数、失败数、通过率
- 用例详情：每个用例的执行状态和错误信息
- 失败截图


#### 2.4.2 报告导出

**导出格式**：HTML

**功能要求**：
- 独立的HTML文件，可直接分享
- 包含完整的执行结果和截图
- 样式美观，易于阅读

---

## 3. 技术需求

### 3.1 技术栈

| 层次 | 技术选型 | 说明 |
|-----|---------|------|
| 前端框架 | Vue 3 | 渐进式JavaScript框架 |
| UI组件库 | Element Plus | Vue 3组件库 |
| 代码编辑器 | Monaco Editor | VS Code同款编辑器 |
| 后端框架 | FastAPI | 现代化Python Web框架 |
| 数据库 | SQLite | 轻量级嵌入式数据库 |
| 自动化引擎 | Playwright | 跨浏览器自动化测试框架 |

### 3.2 系统架构

```
┌─────────────────────────────────────────┐
│            前端层 (Vue 3)                │
│  ┌──────────┐  ┌──────────┐  ┌─────────┐│
│  │脚本编辑器│  │执行控制台│  │报告中心 ││
│  └──────────┘  └──────────┘  └─────────┘│
└───────────────┬─────────────────────────┘
                │ HTTP API
┌───────────────┴─────────────────────────┐
│       应用服务层 (FastAPI)               │
│  ┌──────────┐  ┌──────────┐  ┌─────────┐│
│  │用例管理  │  │执行引擎  │  │报告服务 ││
│  └──────────┘  └──────────┘  └─────────┘│
└───────────────┬─────────────────────────┘
                │
┌───────────────┴─────────────────────────┐
│         数据层 (SQLite)                  │
│  ┌──────────┐  ┌──────────┐             │
│  │测试用例  │  │执行记录  │             │
│  └──────────┘  └──────────┘             │
└─────────────────────────────────────────┘
                │
┌───────────────┴─────────────────────────┐
│       自动化引擎 (Playwright)            │
│  ┌──────────┐  ┌──────────┐  ┌────────┐ │
│  │ Chrome   │  │ Firefox  │  │ Edge   │ │
│  └──────────┘  └──────────┘  └────────┘ │
└─────────────────────────────────────────┘
```

---

## 4. 数据库设计要点

### 4.1 核心数据表

**测试用例表 (test_cases)**
```
- id: 用例ID
- name: 用例名称
- description: 用例描述
- priority: 优先级
- tags: 标签
- folder_id: 所属目录
- created_at: 创建时间
- updated_at: 更新时间
```

**测试步骤表 (test_steps)**
```
- id: 步骤ID
- case_id: 所属用例
- step_order: 步骤顺序
- action_type: 操作类型
- element_locator: 元素定位符
- action_params: 操作参数
- expected_result: 预期结果
```

**执行记录表 (executions)**
```
- id: 执行ID
- execution_type: 执行类型（单用例/批量）
- browser_type: 浏览器类型
- start_time: 开始时间
- end_time: 结束时间
- total_count: 用例总数
- success_count: 成功数
- fail_count: 失败数
```

**执行详情表 (execution_details)**
```
- id: 详情ID
- execution_id: 执行记录
- case_id: 用例ID
- status: 执行状态
- error_message: 错误信息
- screenshot_path: 截图路径
- step_logs: 步骤日志
```

---

## 5. 项目里程碑

### 5.1 阶段一 MVP（2个月）

**目标**：完成核心功能，可进行基础的自动化测试。

**功能清单**：
- 测试脚本编辑器（可视化模式）
- 测试用例管理
- 测试执行引擎（单用例/批量执行）
- 测试报告生成

**交付物**：
- 可运行的系统
- 用户使用手册

### 5.2 阶段二（3个月）

**目标**：增加代码编辑模式，提升灵活性。

**功能清单**：
- 代码编辑模式
- 语法高亮和智能提示

### 5.3 阶段三（4-6个月）

**目标**：支持分布式执行，提升执行效率。

**功能清单**：
- 远程执行节点
- 分布式执行调度
- 执行节点监控

---

## 6. 风险与挑战

### 6.1 技术风险

| 风险 | 影响 | 缓解措施 |
|-----|------|---------|
| 元素定位不稳定 | 用例执行失败率高 | 提供多种定位方式，智能定位优化 |
| 浏览器兼容性问题 | 跨浏览器执行差异 | 充分测试，提供浏览器特定配置 |
| 动态内容处理 | 等待和同步问题 | 完善的等待机制 |

### 6.2 业务风险

| 风险 | 影响 | 缓解措施 |
|-----|------|---------|
| 用户学习成本高 | 用户接受度低 | 提供完善的文档和培训 |
| 用例维护成本 | 页面变化导致大量失败 | 提供批量修复工具 |

### 6.3 项目风险

| 风险 | 影响 | 缓解措施 |
|-----|------|---------|
| 需求变更 | 开发延期 | 采用敏捷开发，小步快跑 |
| 资源不足 | 功能削减 | 优先级管理，分阶段交付 |

---

## 7. 附录

### 7.1 术语表

| 术语 | 解释 |
|-----|------|
| Playwright | 微软开发的跨浏览器自动化测试框架 |
| XPath | 用于在XML/HTML文档中定位元素的语言 |
| CSS Selector | 用于定位HTML元素的CSS选择器 |
| Headless | 无界面的浏览器运行模式 |
| P0/P1/P2/P3 | 优先级等级，P0最高 |

### 7.2 参考文档
- Playwright官方文档：https://playwright.dev/
- FastAPI官方文档：https://fastapi.tiangolo.com/
- Vue 3官方文档：https://vuejs.org/

### 7.3 变更记录

| 版本 | 日期 | 变更内容 |
|-----|------|---------|
| v1.0 | 2025-12-27 | 初始版本 |
